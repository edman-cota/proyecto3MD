---
title: "Proyecto 3, avance 1"
author:
- 'Micaela Yataz (carnet: 18960)'
- 'Edman Cota (carnet: 19830)'
- 'Edwin de Leon (carnet: 22809)'
date: "2025-03-22"
output:
  html_document: default
  pdf_document: default
---

<https://github.com/edman-cota/proyecto3MD.git>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readxl)
library(corrplot)


```

```{r cargando archivo, echo=FALSE}
data <- read.csv("datos.csv")
data <- data[complete.cases(data),]

```

```{r}
install.packages("haven")  # Instala el paquete si no lo tienes
library(haven)

data <- read_sav("mortalidad.sav")  # Cargar archivo
View(data) 
```

#Descripción General del conjunto de datos.

```{r}

summary(data)
```

## Significado y tipo de cada una de las variables

```{r descripcion de variables}

variables <- c("Anio" ,"departamento", "externas", "transito", "violencia", "homicidios", "peso ", " diarrea", "mortalidad", "diabetes ", "circulatorio", "respiratorio")

descripcion<-c("Año" ,"Departamento", "Tasa de mortalidad por causas externas por 100,000 habitantes", "Número de fallecidos en accidentes de tránsito", "Número de denuncias de violencia intrafamiliar", "Número de homicidios por departamento", "Porcentaje de niños con bajo peso al nacer ", " Tasa de mortalidad por diarrea (A09) por cada 100,000 habitantes", "Tasa bruta de mortalidad por cada 1,000 habitantes", "Tasa de mortalidad por diabetes mellitus (E10-E14) por cada 100,000 habitantes ", "Tasa de mortalidad por enfermedades del sistema circulatorio (I00-I99) por 100,000 habitantes", "Tasa de mortalidad por enfermedades del sistema respiratorio (J00-J99) por cada 10,000 habitantes")


tabla1 <- data.frame(descripcion, row.names = variables)
print(tabla1)
```

```{r tipo de variables}



variables <- c("Anio" ,"departamento", "externas", "transito", "violencia", "homicidios", "peso ", " diarrea", "mortalidad", "diabetes ", "circulatorio", "respiratorio")
tipo <- c("Cualitativa nominal" ,"Cualitativa nominal", "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa discreta", "Cuantitativa continua ", " Cuantitativa continua", "Cuantitativa continua", "Cuantitativa continua ", "Cuantitativa continua", "Cuantitativa continua")

tabla0 <- data.frame(tipo, row.names = variables)
print(tabla0)

```

##Cantidad de variables

```{r}
length(variables)
num_variables <-length(variables)
print(paste("El número de variables en la tabla es:", num_variables))
```

## Cantidad de observaciones

```{r}
numero_filas <- nrow(data)
print(paste("El número de observaciones es:", numero_filas))
```

# Exploración de variables numéricas

## Resumen estadístico de variables númericas

```{r}
numeric_vars <- data %>% select_if(is.numeric)
summary(numeric_vars)
```

## Medidas de tendencia central

```{r}
get_mode <- function(x) {
  unique_x <- unique(x)
  unique_x[which.max(tabulate(match(x, unique_x)))]
}

medidas_tendencia <- data.frame(
  Variable = names(numeric_vars),
  Media = sapply(numeric_vars, mean, na.rm = TRUE),
  Mediana = sapply(numeric_vars, median, na.rm = TRUE),
  Moda = sapply(numeric_vars, get_mode)
)

print(medidas_tendencia)
```

## Distribución de variables numéricas

### 1. Histogramas para ver la distribución de cada variable numérica

```{r}
print(data)
numeric_vars %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valor") %>%
  ggplot(aes(x = Anio)) +
  geom_histogram(bandwith, fill = "steelblue", color = "black", alpha = 0.7) +
  facet_wrap(~ Variable, scales = "free") +
  theme_minimal() +
  labs(title = "Distribución de Variables Numéricas", x = "Valor", y = "Frecuencia")
```

### 2. Boxplots para identificar valores atípicos

```{r}
numeric_vars %>%
  pivot_longer(cols = everything(), names_to = "Variable", values_to = "Valor") %>%
  ggplot(aes(x = Variable, y = Valor)) +
  geom_boxplot(fill = "tomato", color = "black", alpha = 0.7) +
  coord_flip() +
  theme_minimal() + 
  labs(title = "Boxplot de variables numéricas", x = "Variable", y = "Valor")
```

## Exploración de variables categóricas

### Identificar variables categóricas

```{r}
categorical_vars <- c("departamento")
```

### Generar tablas de frecuencia

```{r}
for (var in categorical_vars) {
  cat("\nFrecuencia de", var, ":\n")
  print(table(data[[var]]))
}
```

### Visualización con gráficos de barras

```{r}
for (var in categorical_vars) {
  print(
    ggplot(data, aes_string(x = var)) +
      geom_bar(fill = "steelblue", color = "black", alpha = 0.7) +
      theme_minimal() +
      labs(title = paste("Distribución de", var), x = var, y = "Frecuencia") +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  )
}
```

#Tablas de frecuencia #Relaciones entre las variables.

# Relaciones entre variables

## 1. Análisis de correlación entre variables numéricas

# Seleccionamos las variables numéricas

```{r}
numeric_vars <- data %>% select_if(is.numeric)
```

# Calculamos la matriz de correlación

```{r}
cor_matrix <- cor(numeric_vars, use = "complete.obs")
print("Matriz de correlación:")
print(cor_matrix)
```

# Visualizamos la matriz de correlación con la librería corrplot

```{r}
if (!require(corrplot)) {
  install.packages("corrplot")
  library(corrplot)
}
corrplot(cor_matrix, method = "color", type = "upper", tl.cex = 0.8, 
         title = "Matriz de Correlación de Variables Numéricas", mar=c(0,0,1,0))
```

## 2. Gráficos de dispersión (scatter plots) para analizar relaciones bivariadas

# Aquí se genera un gráfico de dispersión para cada par de variables numéricas

```{r}
pairs(numeric_vars, main = "Matriz de Dispersión de Variables Numéricas", pch = 19, col = "steelblue")
```

## 3. Relación entre variables numéricas y la variable categórica "departamento"

# Ejemplo: Boxplot de una variable numérica (por ejemplo, homicidios) según departamento

```{r}
ggplot(data, aes(x = departamento, y = homicidios)) +
  geom_boxplot(fill = "tomato", color = "black", alpha = 0.7) +
  theme_minimal() +
  labs(title = "Distribución de homicidios por departamento", x = "Departamento", y = "Número de homicidios") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
